{# ── Metrics Summary Widget partial ──
     Expects: wid from parent loop
     Data shape: { total_detections, output_count, total_weight, avg_per_hour,
                   hours_span, unique_products, lines_count, downtime_count,
                   downtime_minutes, first_detection, last_detection }
#}
<div x-show="widgetResults['{{ wid }}'] && widgetResults['{{ wid }}'].data && !(widgetResults['{{ wid }}'].metadata && widgetResults['{{ wid }}'].metadata.empty)"
     x-cloak class="widget-card-body">
  <h3 class="text-xs font-semibold text-gray-400 uppercase tracking-wider mb-3"
      x-text="widgetResults['{{ wid }}']?.widget_name"></h3>
  <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
    <div class="bg-surface-800 rounded-lg p-3 text-center">
      <p class="text-xl font-bold text-blue-500" x-text="widgetResults['{{ wid }}']?.data?.output_count?.toLocaleString('es-AR')"></p>
      <p class="text-[10px] text-gray-500 uppercase">Producción</p>
    </div>
    <div class="bg-surface-800 rounded-lg p-3 text-center">
      <p class="text-xl font-bold text-green-500" x-text="widgetResults['{{ wid }}']?.data?.total_weight?.toLocaleString('es-AR') + ' kg'"></p>
      <p class="text-[10px] text-gray-500 uppercase">Peso Total</p>
    </div>
    <div class="bg-surface-800 rounded-lg p-3 text-center">
      <p class="text-xl font-bold text-purple-500" x-text="widgetResults['{{ wid }}']?.data?.avg_per_hour + '/h'"></p>
      <p class="text-[10px] text-gray-500 uppercase">Promedio/Hora</p>
    </div>
    <div class="bg-surface-800 rounded-lg p-3 text-center">
      <p class="text-xl font-bold text-amber-500" x-text="widgetResults['{{ wid }}']?.data?.unique_products"></p>
      <p class="text-[10px] text-gray-500 uppercase">Productos</p>
    </div>
    <div class="bg-surface-800 rounded-lg p-3 text-center">
      <p class="text-xl font-bold text-cyan-500" x-text="widgetResults['{{ wid }}']?.data?.lines_count"></p>
      <p class="text-[10px] text-gray-500 uppercase">Líneas</p>
    </div>
    <div class="bg-surface-800 rounded-lg p-3 text-center">
      <p class="text-xl font-bold text-gray-400" x-text="widgetResults['{{ wid }}']?.data?.hours_span + 'h'"></p>
      <p class="text-[10px] text-gray-500 uppercase">Período</p>
    </div>
    <div class="bg-surface-800 rounded-lg p-3 text-center">
      <p class="text-sm text-gray-300" x-text="widgetResults['{{ wid }}']?.data?.first_detection"></p>
      <p class="text-[10px] text-gray-500 uppercase">Primera Detección</p>
    </div>
    <div class="bg-surface-800 rounded-lg p-3 text-center">
      <p class="text-sm text-gray-300" x-text="widgetResults['{{ wid }}']?.data?.last_detection"></p>
      <p class="text-[10px] text-gray-500 uppercase">Última Detección</p>
    </div>
  </div>
</div>
