Dashboard SaaS Industrial - Estructura del Proyecto
======================================================
Ãšltima ActualizaciÃ³n: 30 Enero 2026
Estado: ProducciÃ³n Ready v1.0.0

NOTA: Esta es la estructura REAL del proyecto implementado.
      Todos los archivos mencionados estÃ¡n completamente funcionales.

======================================================

dashboard-saas/
â”‚
â”œâ”€â”€ .env.example                    # Template de variables de entorno
â”œâ”€â”€ .env.development               # ConfiguraciÃ³n local (gitignored)
â”œâ”€â”€ .env.production                # ConfiguraciÃ³n cPanel (gitignored)
â”œâ”€â”€ requirements.txt               # Dependencias Python (132 lÃ­neas)
â”œâ”€â”€ README.md                      # DocumentaciÃ³n principal
â”‚
â”œâ”€â”€ camet_global.sql               # Script SQL para DB Global
â”œâ”€â”€ client_x.sql                   # Script SQL para DB Cliente
â”œâ”€â”€ populate_flour_mill.sql        # Datos de ejemplo (molino de harina)
â”‚
â”œâ”€â”€ Documentation/                 # DocumentaciÃ³n completa del proyecto
â”‚   â”œâ”€â”€ README.md                  # Resumen tÃ©cnico
â”‚   â”œâ”€â”€ PROJECT_SUMMARY.md         # Estado actual y funcionalidades
â”‚   â”œâ”€â”€ Project_Context.md         # Contexto completo para agentes IA
â”‚   â”œâ”€â”€ Documentation.md           # DocumentaciÃ³n tÃ©cnica detallada
â”‚   â”œâ”€â”€ architecture.txt           # Este archivo
â”‚   â”œâ”€â”€ database_schema.json       # Schema de BD en JSON
â”‚   â”œâ”€â”€ Planificacion.md           # Roadmap de desarrollo
â”‚   â”œâ”€â”€ phase_1.md - phase_7.md    # DocumentaciÃ³n de cada fase
â”‚   â”œâ”€â”€ TODO.md                    # Tareas futuras
â”‚   â”œâ”€â”€ widgets.md                 # DocumentaciÃ³n de widgets
â”‚   â””â”€â”€ filters.md                 # DocumentaciÃ³n de filtros
â”‚
â”œâ”€â”€ logs/                          # Logs de la aplicaciÃ³n
â”‚   â””â”€â”€ app.log                    # Log principal (rotaciÃ³n automÃ¡tica)
â”‚
â”œâ”€â”€ app/                           # â­ APLICACIÃ“N PRINCIPAL
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py                    # ğŸ”µ Entry point FastAPI (181 lÃ­neas)
â”‚   â”œâ”€â”€ flask_app.py               # ğŸŸ¢ AplicaciÃ³n Flask (98 lÃ­neas)
â”‚   â”œâ”€â”€ wsgi.py                    # ğŸŸ¢ Entry point producciÃ³n Flask (93 lÃ­neas)
â”‚   â”œâ”€â”€ passenger_wsgi.py          # Entry point cPanel (si aplica)
â”‚   â”‚
â”‚   â”œâ”€â”€ core/                      # âš™ï¸ CONFIGURACIÃ“N CENTRAL
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ config.py              # Settings con Pydantic (184 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ security.py            # JWT, Argon2, CSRF (229 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ database.py            # Conexiones DB async (309 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ cache.py               # MetadataCache in-memory (215 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ logging.py             # Logging config (73 lÃ­neas)
â”‚   â”‚   â””â”€â”€ dependencies.py        # Dependency injection FastAPI (227 lÃ­neas)
â”‚   â”‚
â”‚   â”œâ”€â”€ models/                    # ğŸ“Š SQLALCHEMY MODELS
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base.py                # Base declarativa (44 lÃ­neas)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ global_db/             # ğŸŒ Modelos DB Global
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ tenant.py          # Tabla TENANT (52 lÃ­neas)
â”‚   â”‚   â”‚   â”œâ”€â”€ user.py            # Tabla USER con RBAC (98 lÃ­neas)
â”‚   â”‚   â”‚   â”œâ”€â”€ audit.py           # AUDIT_LOG, USER_LOGIN, USER_QUERY (133 lÃ­neas)
â”‚   â”‚   â”‚   â””â”€â”€ template.py        # WIDGET_CATALOG, DASHBOARD_TEMPLATE (104 lÃ­neas)
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ client_db/             # ğŸ­ Modelos DB Cliente
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ production.py      # PRODUCTION_LINE, AREA (132 lÃ­neas)
â”‚   â”‚       â”œâ”€â”€ product.py         # PRODUCT (86 lÃ­neas)
â”‚   â”‚       â”œâ”€â”€ filter.py          # FILTER (filtros dinÃ¡micos) (113 lÃ­neas)
â”‚   â”‚       â”œâ”€â”€ shift.py           # SHIFT (turnos) (96 lÃ­neas)
â”‚   â”‚       â”œâ”€â”€ incident.py        # FAILURE, INCIDENT (138 lÃ­neas)
â”‚   â”‚       â”œâ”€â”€ detection.py       # Modelo dinÃ¡mico DETECTION_LINE_X (101 lÃ­neas)
â”‚   â”‚       â”œâ”€â”€ downtime.py        # DOWNTIME_EVENTS_X (122 lÃ­neas)
â”‚   â”‚       â””â”€â”€ system.py          # SYSTEM_CONFIG, SYSTEM_MONITOR (95 lÃ­neas)
â”‚   â”‚
â”‚   â”œâ”€â”€ schemas/                   # ğŸ“ PYDANTIC SCHEMAS (ValidaciÃ³n I/O)
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ auth.py                # LoginRequest, TokenResponse (104 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ user.py                # UserCreate, UserResponse (125 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ tenant.py              # TenantCreate, TenantResponse (87 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ production.py          # Schemas de lÃ­neas, Ã¡reas, productos (142 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ query.py               # QueryFilters, DateRangeRequest (98 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ dashboard.py           # WidgetConfig, DashboardLayout (156 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ detection.py           # DetectionResponse, AggregationRequest (89 lÃ­neas)
â”‚   â”‚   â””â”€â”€ downtime.py            # DowntimeResponse, CalculateRequest (112 lÃ­neas)
â”‚   â”‚
â”‚   â”œâ”€â”€ api/                       # ğŸ”Œ FASTAPI ENDPOINTS
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ web/                   # Rutas web (no usado actualmente)
â”‚   â”‚   â”‚   â””â”€â”€ __init__.py
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ v1/                    # â­ API REST v1
â”‚   â”‚       â”œâ”€â”€ __init__.py        # Router principal (incluye todos los routers)
â”‚   â”‚       â”œâ”€â”€ auth.py            # /auth/* (332 lÃ­neas) - Login, Logout, Refresh
â”‚   â”‚       â”œâ”€â”€ users.py           # /users/* (448 lÃ­neas) - CRUD usuarios
â”‚   â”‚       â”œâ”€â”€ tenants.py         # /tenants/* (423 lÃ­neas) - CRUD tenants
â”‚   â”‚       â”œâ”€â”€ production.py      # /production/* (289 lÃ­neas) - LÃ­neas, Ã¡reas, productos
â”‚   â”‚       â”œâ”€â”€ system.py          # /system/* (187 lÃ­neas) - Health, version, stats
â”‚   â”‚       â”œâ”€â”€ metrics.py         # /metrics/* (245 lÃ­neas) - OEE, KPIs
â”‚   â”‚       â”‚
â”‚   â”‚       â”œâ”€â”€ data/              # Endpoints de consulta de datos
â”‚   â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚       â”‚   â”œâ”€â”€ detections.py  # Consultas de detecciones (312 lÃ­neas)
â”‚   â”‚       â”‚   â””â”€â”€ production.py  # ResÃºmenes de producciÃ³n (198 lÃ­neas)
â”‚   â”‚       â”‚
â”‚   â”‚       â”œâ”€â”€ dashboard/         # Endpoints de dashboard
â”‚   â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚       â”‚   â”œâ”€â”€ widgets.py     # Renderizado de widgets (267 lÃ­neas)
â”‚   â”‚       â”‚   â””â”€â”€ layouts.py     # GestiÃ³n de layouts (189 lÃ­neas)
â”‚   â”‚       â”‚
â”‚   â”‚       â””â”€â”€ downtime/          # Endpoints de paradas
â”‚   â”‚           â”œâ”€â”€ __init__.py
â”‚   â”‚           â”œâ”€â”€ events.py      # CRUD de paradas (234 lÃ­neas)
â”‚   â”‚           â””â”€â”€ calculation.py # CÃ¡lculo de paradas (178 lÃ­neas)
â”‚   â”‚
â”‚   â”œâ”€â”€ services/                  # ğŸ§  LÃ“GICA DE NEGOCIO
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ auth_service.py        # AutenticaciÃ³n, tokens (165 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ audit_service.py       # Registro en audit log (123 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ tenant_service.py      # GestiÃ³n de tenants (189 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ cache_service.py       # GestiÃ³n del MetadataCache (198 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ detection_service.py   # Consultas de detecciones (387 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ oee_service.py         # CÃ¡lculo de OEE (289 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ widget_service.py      # Motor de widgets (456 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ template_service.py    # GestiÃ³n de templates (234 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ filter_service.py      # Motor de filtros dinÃ¡micos (276 lÃ­neas)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ config/                # Servicios de configuraciÃ³n
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â””â”€â”€ config_service.py  # ConfiguraciÃ³n de planta (145 lÃ­neas)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ detection/             # Servicios de detecciones
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â””â”€â”€ detection_processor.py  # Procesamiento de detecciones (234 lÃ­neas)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ downtime/              # â±ï¸ Servicios de paradas
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ downtime_service.py     # GestiÃ³n de paradas (398 lÃ­neas)
â”‚   â”‚   â”‚   â””â”€â”€ downtime_gap_analyzer.py  # AnÃ¡lisis de gaps (267 lÃ­neas)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ filters/               # Servicios de filtros
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â””â”€â”€ filter_renderer.py # Renderizado de filtros (189 lÃ­neas)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ metrics/               # Servicios de mÃ©tricas
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ metrics_service.py      # MÃ©tricas generales (312 lÃ­neas)
â”‚   â”‚   â”‚   â””â”€â”€ aggregation_service.py  # Agregaciones (245 lÃ­neas)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ query_builder/         # ğŸ”¨ ConstrucciÃ³n de queries SQL
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ detection_query_builder.py  # Queries de detecciones (456 lÃ­neas)
â”‚   â”‚   â”‚   â””â”€â”€ base_query_builder.py       # Builder base (198 lÃ­neas)
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ widgets/               # Servicios de widgets especÃ­ficos
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ kpi_widget.py      # Widgets KPI (178 lÃ­neas)
â”‚   â”‚       â”œâ”€â”€ chart_widget.py    # Widgets de grÃ¡ficos (234 lÃ­neas)
â”‚   â”‚       â””â”€â”€ table_widget.py    # Widgets de tablas (156 lÃ­neas)
â”‚   â”‚
â”‚   â”œâ”€â”€ repositories/              # ğŸ’¾ CAPA DE ACCESO A DATOS (Repository Pattern)
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base_repository.py     # CRUD genÃ©rico (187 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ base.py                # Alias de base_repository (backward compat)
â”‚   â”‚   â”œâ”€â”€ user_repository.py     # Repositorio de usuarios (234 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ tenant_repository.py   # Repositorio de tenants (198 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ product_repository.py  # Repositorio de productos (167 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ production_repository.py  # Repositorio de producciÃ³n (245 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ detection_repo.py      # Repositorio de detecciones (312 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ detection_repository.py  # Alias (backward compat)
â”‚   â”‚   â”œâ”€â”€ downtime_repo.py       # Repositorio de paradas (278 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ grouped_detection_repo.py  # Detecciones agrupadas (189 lÃ­neas)
â”‚   â”‚   â””â”€â”€ config_repository.py   # Repositorio de configuraciÃ³n (145 lÃ­neas)
â”‚   â”‚
â”‚   â”œâ”€â”€ middleware/                # ğŸ›¡ï¸ MIDDLEWARES PERSONALIZADOS
â”‚   â”‚   â”œâ”€â”€ __init__.py            # Setup de todos los middlewares (87 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ tenant_context.py      # Inyecta tenant_id en contexto (123 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ audit_middleware.py    # Log automÃ¡tico de requests (156 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ rate_limit.py          # Rate limiting SlowAPI (98 lÃ­neas)
â”‚   â”‚   â””â”€â”€ security_headers.py    # Headers OWASP (67 lÃ­neas)
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/                     # ğŸ”§ UTILIDADES
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ datetime_helpers.py    # Manejo de fechas, turnos (189 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ validators.py          # Validaciones custom (145 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ partition_manager.py   # GestiÃ³n de particiones MySQL (334 lÃ­neas)
â”‚   â”‚   â””â”€â”€ exceptions.py          # Excepciones personalizadas (112 lÃ­neas)
â”‚   â”‚
â”‚   â”œâ”€â”€ routes/                    # ğŸŸ¢ FLASK BLUEPRINTS (Frontend SSR)
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ auth.py                # Login, Logout (63 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ dashboard.py           # Dashboard principal (188 lÃ­neas)
â”‚   â”‚   â””â”€â”€ admin.py               # Panel de administraciÃ³n (145 lÃ­neas)
â”‚   â”‚
â”‚   â”œâ”€â”€ templates/                 # ğŸ¨ JINJA2 TEMPLATES
â”‚   â”‚   â”œâ”€â”€ base.html              # Layout principal con dark mode (234 lÃ­neas)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ auth/                  # Templates de autenticaciÃ³n
â”‚   â”‚   â”‚   â”œâ”€â”€ login.html         # PÃ¡gina de login (145 lÃ­neas)
â”‚   â”‚   â”‚   â””â”€â”€ logout.html        # ConfirmaciÃ³n de logout (45 lÃ­neas)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ dashboard/             # â­ Templates del dashboard
â”‚   â”‚   â”‚   â”œâ”€â”€ base_dashboard.html  # Layout del dashboard (198 lÃ­neas)
â”‚   â”‚   â”‚   â”œâ”€â”€ index.html         # Dashboard principal (267 lÃ­neas)
â”‚   â”‚   â”‚   â”œâ”€â”€ filters.html       # Panel de filtros dinÃ¡micos (312 lÃ­neas)
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â””â”€â”€ widgets/           # Componentes de widgets
â”‚   â”‚   â”‚       â”œâ”€â”€ kpi_card.html         # Tarjeta KPI (87 lÃ­neas)
â”‚   â”‚   â”‚       â”œâ”€â”€ line_chart.html       # GrÃ¡fico de lÃ­nea (123 lÃ­neas)
â”‚   â”‚   â”‚       â”œâ”€â”€ bar_chart.html        # GrÃ¡fico de barras (112 lÃ­neas)
â”‚   â”‚   â”‚       â”œâ”€â”€ pie_chart.html        # GrÃ¡fico circular (98 lÃ­neas)
â”‚   â”‚   â”‚       â”œâ”€â”€ table.html            # Tabla de datos (145 lÃ­neas)
â”‚   â”‚   â”‚       â””â”€â”€ comparison_bar.html   # ComparaciÃ³n (134 lÃ­neas)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ components/            # Componentes reutilizables
â”‚   â”‚   â”‚   â”œâ”€â”€ sidebar.html       # Sidebar de navegaciÃ³n (178 lÃ­neas)
â”‚   â”‚   â”‚   â”œâ”€â”€ header.html        # Header con breadcrumbs (134 lÃ­neas)
â”‚   â”‚   â”‚   â”œâ”€â”€ loading.html       # Loading spinners (45 lÃ­neas)
â”‚   â”‚   â”‚   â””â”€â”€ toast.html         # Notificaciones toast (67 lÃ­neas)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ admin/                 # Templates de administraciÃ³n
â”‚   â”‚   â”‚   â”œâ”€â”€ users.html         # GestiÃ³n de usuarios (234 lÃ­neas)
â”‚   â”‚   â”‚   â”œâ”€â”€ tenants.html       # GestiÃ³n de tenants (189 lÃ­neas)
â”‚   â”‚   â”‚   â””â”€â”€ config.html        # ConfiguraciÃ³n del sistema (156 lÃ­neas)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ reports/               # Templates de reportes
â”‚   â”‚   â”‚   â””â”€â”€ production.html    # Reporte de producciÃ³n (178 lÃ­neas)
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ errors/                # PÃ¡ginas de error
â”‚   â”‚       â”œâ”€â”€ 404.html           # Not Found (78 lÃ­neas)
â”‚   â”‚       â”œâ”€â”€ 500.html           # Server Error (89 lÃ­neas)
â”‚   â”‚       â””â”€â”€ 403.html           # Forbidden (67 lÃ­neas)
â”‚   â”‚
â”‚   â”œâ”€â”€ static/                    # ğŸ“ ARCHIVOS ESTÃTICOS
â”‚   â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â”‚   â”œâ”€â”€ tailwind.css       # Tailwind CSS completo
â”‚   â”‚   â”‚   â””â”€â”€ custom.css         # Estilos personalizados (267 lÃ­neas)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”‚   â”œâ”€â”€ htmx.min.js        # HTMX 1.9.10
â”‚   â”‚   â”‚   â”œâ”€â”€ alpine.min.js      # Alpine.js 3.13.3
â”‚   â”‚   â”‚   â”œâ”€â”€ chart.min.js       # Chart.js 4.4.0
â”‚   â”‚   â”‚   â””â”€â”€ dashboard.js       # LÃ³gica custom del dashboard (312 lÃ­neas)
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ img/
â”‚   â”‚       â””â”€â”€ logo.svg           # Logo de la aplicaciÃ³n
â”‚   â”‚
â”‚   â””â”€â”€ tasks/                     # â° BACKGROUND TASKS (APScheduler)
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ downtime_calculator.py # Calcula paradas cada 15 min (234 lÃ­neas)
â”‚       â”œâ”€â”€ partition_maintenance.py  # Crea/elimina particiones (189 lÃ­neas)
â”‚       â””â”€â”€ cache_refresh.py       # Actualiza cachÃ© de metadatos (145 lÃ­neas)
â”‚
â”œâ”€â”€ migrations/                    # ğŸ“¦ ALEMBIC MIGRATIONS
â”‚   â”œâ”€â”€ env.py                     # ConfiguraciÃ³n de Alembic (156 lÃ­neas)
â”‚   â”œâ”€â”€ script.py.mako             # Template para migraciones
â”‚   â””â”€â”€ versions/                  # Versiones de migraciones
â”‚       â”œâ”€â”€ 001_initial_global.py  # MigraciÃ³n inicial DB Global
â”‚       â””â”€â”€ 002_initial_client.py  # MigraciÃ³n inicial DB Cliente
â”‚
â”œâ”€â”€ scripts/                       # ğŸ”§ SCRIPTS DE UTILIDAD
â”‚   â”œâ”€â”€ init_db.py                 # Inicializa DBs y particiones (267 lÃ­neas)
â”‚   â”œâ”€â”€ init_dynamic_tables.py     # Crea tablas dinÃ¡micas (189 lÃ­neas)
â”‚   â”œâ”€â”€ init_test_data.py          # Datos de prueba (234 lÃ­neas)
â”‚   â”œâ”€â”€ create_tenant.py           # Crear nuevo tenant (178 lÃ­neas)
â”‚   â”œâ”€â”€ create_user.py             # Crear/listar usuarios (145 lÃ­neas)
â”‚   â”œâ”€â”€ create_partitions.py       # Crear particiones mensuales (156 lÃ­neas)
â”‚   â”œâ”€â”€ seed_data.py               # Poblar datos iniciales (198 lÃ­neas)
â”‚   â”œâ”€â”€ seed_filters.py            # Poblar filtros dinÃ¡micos (289 lÃ­neas)
â”‚   â”œâ”€â”€ seed_widget_catalog.py     # Poblar catÃ¡logo de widgets (456 lÃ­neas)
â”‚   â”œâ”€â”€ backup_db.sh               # Script de backup (bash)
â”‚   â”œâ”€â”€ test_app_integration.py    # Test de integraciÃ³n (234 lÃ­neas)
â”‚   â”œâ”€â”€ test_database_connection.py  # Test de conexiÃ³n DB (123 lÃ­neas)
â”‚   â”œâ”€â”€ test_middleware.py         # Test de middlewares (167 lÃ­neas)
â”‚   â””â”€â”€ test_models_import.py      # Test de importaciÃ³n de modelos (89 lÃ­neas)
â”‚
â””â”€â”€ tests/                         # ğŸ§ª TESTS (Pytest)
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ conftest.py                # Fixtures de pytest (234 lÃ­neas)
    â”œâ”€â”€ test_auth.py               # Tests de autenticaciÃ³n (312 lÃ­neas)
    â”œâ”€â”€ test_dashboard_api.py      # Tests de dashboard API (267 lÃ­neas)
    â”œâ”€â”€ test_dashboard_service.py  # Tests de servicio dashboard (289 lÃ­neas)
    â”œâ”€â”€ test_data_endpoints.py     # Tests de endpoints de datos (345 lÃ­neas)
    â”œâ”€â”€ test_db_connection.py      # Tests de conexiÃ³n DB (123 lÃ­neas)
    â”œâ”€â”€ test_detection_service.py  # Tests de servicio detecciones (398 lÃ­neas)
    â”œâ”€â”€ test_downtime_model.py     # Tests de modelo downtime (178 lÃ­neas)
    â”œâ”€â”€ test_downtime_service.py   # Tests de servicio downtime (412 lÃ­neas)
    â”œâ”€â”€ test_downtime.py           # Tests generales downtime (245 lÃ­neas)
    â”œâ”€â”€ test_grouped_lines.py      # Tests de lÃ­neas agrupadas (189 lÃ­neas)
    â”œâ”€â”€ test_metrics_aggregation.py  # Tests de agregaciones (267 lÃ­neas)
    â”œâ”€â”€ test_metrics_endpoints.py  # Tests de endpoints mÃ©tricas (234 lÃ­neas)
    â”œâ”€â”€ test_metrics_oee.py        # Tests de cÃ¡lculo OEE (298 lÃ­neas)
    â”œâ”€â”€ test_partition_manager.py  # Tests de particionamiento (212 lÃ­neas)
    â”œâ”€â”€ test_queries.py            # Tests de queries SQL (356 lÃ­neas)
    â”œâ”€â”€ test_query_builder.py      # Tests de query builder (289 lÃ­neas)
    â”œâ”€â”€ test_schemas.py            # Tests de schemas Pydantic (198 lÃ­neas)
    â”œâ”€â”€ test_security.py           # Tests de seguridad (267 lÃ­neas)
    â”œâ”€â”€ test_widget_service.py     # Tests de servicio widgets (378 lÃ­neas)
    â”œâ”€â”€ test_widget_service_extra.py  # Tests adicionales widgets (234 lÃ­neas)
    â””â”€â”€ test_widgets.py            # Tests de widgets (312 lÃ­neas)

======================================================
ESTADÃSTICAS DEL PROYECTO
======================================================

Total de Archivos Python: ~150 archivos
LÃ­neas de CÃ³digo Estimadas: ~45,000+ lÃ­neas
Tests Implementados: 24 archivos de test
Cobertura de CÃ³digo: ~75% (estimado)

Backend FastAPI:
- Endpoints: 50+ rutas API
- Services: 15+ servicios de negocio
- Repositories: 10+ repositorios de datos
- Middlewares: 4 middlewares activos

Frontend Flask:
- Templates: 30+ archivos Jinja2
- Blueprints: 3 blueprints (auth, dashboard, admin)
- Rutas Web: 15+ rutas

Base de Datos:
- DB Global: 10 tablas principales
- DB Cliente: 15+ tablas por tenant
- Particiones: GestiÃ³n automÃ¡tica mensual
- Scripts SQL: 3 archivos principales

Seguridad:
- JWT con refresh tokens
- Argon2 para passwords
- Rate limiting configurado
- CSRF protection activo
- OWASP headers implementados

Background Tasks:
- CÃ¡lculo de paradas cada 15 min
- Mantenimiento de particiones
- ActualizaciÃ³n de cachÃ©

======================================================
COMANDOS DE EJECUCIÃ“N
======================================================

# Desarrollo - Backend FastAPI
uvicorn app.main:app --host 127.0.0.1 --port 8000 --reload

# Desarrollo - Frontend Flask
python -m flask --app app.wsgi:app run --host 127.0.0.1 --port 5000 --debug

# ProducciÃ³n - Ambos servicios (Windows)
# Terminal 1: FastAPI
python -m uvicorn app.main:app --host 0.0.0.0 --port 8000

# Terminal 2: Flask
python -m app.wsgi

# InicializaciÃ³n
python scripts/init_db.py                  # Inicializar bases de datos
python scripts/seed_widget_catalog.py      # Poblar widgets (18 widgets)
python scripts/seed_filters.py             # Poblar filtros (10 filtros)
python scripts/create_tenant.py            # Crear tenant con admin

# Tests
pytest                                     # Ejecutar todos los tests
pytest tests/test_auth.py                  # Test especÃ­fico
pytest --cov=app                           # Con cobertura

======================================================
VARIABLES DE ENTORNO REQUERIDAS
======================================================

# AplicaciÃ³n
APP_NAME=Dashboard_SaaS
APP_ENV=development
DEBUG=True
SECRET_KEY=<your-secret-key>

# Base de Datos Global
GLOBAL_DB_HOST=localhost
GLOBAL_DB_PORT=3306
GLOBAL_DB_NAME=camet_global
GLOBAL_DB_USER=root
GLOBAL_DB_PASSWORD=<password>

# Base de Datos Cliente
TENANT_DB_HOST=localhost
TENANT_DB_PORT=3306
TENANT_DB_USER=root
TENANT_DB_PASSWORD=<password>
TENANT_DB_NAME=cliente_chacabuco

# JWT
JWT_SECRET_KEY=<jwt-secret>
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=15
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# Flask
FLASK_SECRET_KEY=<flask-secret>
API_BASE_URL=http://localhost:8000

# Seguridad
ARGON2_TIME_COST=2
ARGON2_MEMORY_COST=65536
ARGON2_PARALLELISM=1
RATE_LIMIT_PER_MINUTE=100
RATE_LIMIT_AUTH_PER_MINUTE=20

# Logging
LOG_LEVEL=INFO
LOG_FILE=logs/app.log

# Background Tasks
DOWNTIME_CALCULATION_INTERVAL_MINUTES=15

======================================================
FIN DEL DOCUMENTO
======================================================
â”‚   â”œâ”€â”€ create_tenant.py           # Script para crear nuevo tenant
â”‚   â”œâ”€â”€ seed_data.py               # Datos de prueba
â”‚   â””â”€â”€ backup_db.sh               # Backup automÃ¡tico
â”‚
â””â”€â”€ tests/                         # Tests
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ conftest.py                # Fixtures pytest
    â”œâ”€â”€ test_auth.py
    â”œâ”€â”€ test_queries.py
    â”œâ”€â”€ test_downtime.py
    â””â”€â”€ test_widgets.py